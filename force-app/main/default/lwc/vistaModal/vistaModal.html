<template>
    <lightning-modal-body>
        <!-- Custom Header (no X) -->
        <div class="slds-text-heading_medium slds-p-bottom_medium">Cerca Paziente</div>

        <!-- Search Input -->
        <div class="slds-form-element slds-m-bottom_medium">
            <label class="slds-form-element__label" for="searchInput">Nome del Paziente</label>
            <div class="slds-form-element__control">
                <lightning-input
                    type="text"
                    id="searchInput"
                    value={searchTerm}
                    onchange={handleInputChange}
                    placeholder="Digita per cercare..."
                ></lightning-input>
            </div>
        </div>

        <!-- Dropdown Results -->
        <template if:true={showDropdown}>
            <div class="slds-scrollable_y slds-box slds-m-bottom_medium" style="max-height: 200px;">
                <ul class="slds-listbox slds-listbox_vertical" role="listbox">
                    <template for:each={records} for:item="record">
                        <li key={record.id} class="slds-listbox__item" role="presentation">
                            <div class="slds-media slds-listbox__option slds-listbox__option_entity slds-media_center"
                                role="option"
                                data-id={record.id}
                                data-name={record.Name}
                                onclick={handleSelect}>
                                <span class="slds-media__figure slds-listbox__option-icon">
                                    <lightning-icon icon-name="standard:contact" size="x-small"></lightning-icon>
                                </span>
                                <span class="slds-media__body">
                                    <span class="slds-truncate">{record.Name}</span>
                                </span>
                            </div>
                        </li>
                    </template>
                </ul>
            </div>
        </template>
    </lightning-modal-body>

    <lightning-modal-footer>
        <lightning-button variant="neutral" label="Chiudi" onclick={handleClose} class="slds-m-right_small"></lightning-button>
        <lightning-button variant="brand" label="Avanti" onclick={handleNext}></lightning-button>
    </lightning-modal-footer>
</template>